sudo: required
dist: trusty
language: cpp


cache: apt

before_install:
  - ls
  - sudo apt-get -qq update
  - sudo apt-get install -y build-essential
  - sudo apt-get install -y wget git
  - sudo apt-get install -y p7zip
  - sudo apt-get install -y mingw-w64
  - sudo apt-get install -y gcc-mingw-w64-x86-64
  - sudo apt-get install -y g++-mingw-w64-x86-64
  - sudo apt-get install -y cmake
  - sudo apt-get install -y make
  - sudo apt-get install -y pkg-config
  - sudo apt-get install -y unzip
  - git clone https://github.com/olegklimov/bullet3 -b roboschool_self_collision
  - wget https://github.com/TheCrazyT/roboschool/releases/download/v0.0.1-beta.1/precompiled_headers.7z
  - wget https://dl.bintray.com/boostorg/release/1.66.0/source/boost_1_66_0.zip
  - wget https://download.qt.io/official_releases/qt/5.10/5.10.0/single/qt-everywhere-src-5.10.0.tar.xz

before_script:
  - 7zr x precompiled_headers.7z 1>/dev/null 2>/dev/null
  - unzip boost_1_66_0.zip 1>/dev/null 2>/dev/null
  - tar xf qt-everywhere-src-5.10.0.tar.xz 1>/dev/null 2>/dev/null
  - cd qt-everywhere-src-5.10.0
  - ./configure -opensource
  - cd ..
script:
  - ROBOSCHOOL_PATH=$(pwd)
  - mkdir bullet3/build
  - cd    bullet3/build
  - cmake -DBUILD_SHARED_LIBS=ON -DUSE_DOUBLE_PRECISION=1 -DCMAKE_INSTALL_PREFIX:PATH=$ROBOSCHOOL_PATH/roboschool/cpp-household/bullet_local_install -DBUILD_CPU_DEMOS=OFF -DBUILD_BULLET2_DEMOS=OFF -DBUILD_EXTRAS=OFF  -DBUILD_UNIT_TESTS=OFF -DBUILD_CLSOCKET=OFF -DBUILD_ENET=OFF -DBUILD_OPENGL3_DEMOS=OFF ..
  - make -j4
  - make install
  - cd ../..
  - cd roboschool/cpp-household
  - make CROSS_MINGW=1